<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../img/favicon.ico">

    
    <title>Testes e regi√µes de confian√ßa - Teaching Assistant</title>
    

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/v4-shims.css">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.min.css">
    <link href='//rsms.me/inter/inter.css' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin' rel='stylesheet' type='text/css'>
    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="../../css/base.min.css" rel="stylesheet">
    <link href="../../css/cinder.min.css" rel="stylesheet">

    
        
        <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/github.min.css">
        
    

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
        <![endif]-->

    

     
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->

            
              <a class="navbar-brand" href="../..">Teaching Assistant</a>
            
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../alglin/info/">√Ålgebra Linear</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../analisenum/info/">An√°lise Num√©rica</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../curvas/info/">Curvas</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../edo/info/">EDO</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../edp/info/">EDP</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Estat√≠stica <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../infestatistica/info/">Infer√™ncia Estat√≠stica</a>
</li>

                        
                            
<li >
    <a href="../info/">Estat√≠stica Bayesiana</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>

            <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                            <i class="fas fa-search"></i> Search
                        </a>
                    </li>
                    <li>
                        <a href="https://lucasmoschen.github.io">P√°gina Inicial</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

    <div class="container">
        
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="first-level active"><a href="#testes-e-regioes-de-confianca">Testes e regi√µes de confian√ßa</a></li>
            <li class="second-level"><a href="#uma-primeira-abordagem">Uma primeira abordagem</a></li>
                
                <li class="third-level"><a href="#fator-de-bayes">Fator de Bayes</a></li>
            <li class="second-level"><a href="#comparacao-com-a-abordagem-classica">Compara√ß√£o com a abordagem cl√°ssica</a></li>
                
                <li class="third-level"><a href="#testes-ump">Testes UMP</a></li>
                <li class="third-level"><a href="#prioris-menos-favoraveis">Prioris menos favor√°veis</a></li>
                <li class="third-level"><a href="#p-valores">p-valores</a></li>
                <li class="third-level"><a href="#respostas-bayesianas-menos-favoraveis">Respostas bayesianas menos favor√°veis</a></li>
                <li class="third-level"><a href="#caso-unilateral">Caso unilateral</a></li>
            <li class="second-level"><a href="#uma-segunda-abordagem">Uma segunda abordagem</a></li>
                
            <li class="second-level"><a href="#regioes-de-confianca">Regi√µes de confian√ßa</a></li>
                
                <li class="third-level"><a href="#intervalos-de-credibilidade">Intervalos de credibilidade</a></li>
                <li class="third-level"><a href="#intervalos-de-confianca-classicos">Intervalos de confian√ßa cl√°ssicos</a></li>
                <li class="third-level"><a href="#avaliacao-baseada-em-teoria-da-decisao">Avalia√ß√£o baseada em teoria da decis√£o</a></li>
    </ul>
</div></div>
        <div class="col-md-9" role="main">

<h1 id="testes-e-regioes-de-confianca">Testes e regi√µes de confian√ßa</h1>
<p>Com a abordagem bayesiana, podemos fazer afirma√ß√µes do tipo <script type="math/tex">\pi(\theta \in \Theta_0 | x)</script>, o que √© difere da proposta frequentista, j√° que l√° o par√¢metro √© fixo, apesar de desconhecido. 
Alguns bayesianos acreditam que o teste, em especial o teste com hip√≥tese nula pontual, n√£o deveria ser realizado por diversos motivos: representa√ß√£o redutiva do modelo; priori modificada de forma n√£o natural para representar a quest√£o pontual; falta de estrutura baseada em teoria da decis√£o; impossibilidade do uso de prioris impr√≥prias.</p>
<h2 id="uma-primeira-abordagem">Uma primeira abordagem</h2>
<p>Considere um modelo <script type="math/tex">f(x|\theta)</script> com <script type="math/tex">\theta \in \Theta</script>. 
Queremos verificar <script type="math/tex">H_0 : \theta \in \Theta_0</script> com <script type="math/tex">\Theta_0 \subseteq \Theta</script> sendo um subconjunto de interesse.
Chamamos <script type="math/tex">H_0</script> de <strong>hip√≥tese nula</strong>. 
Em contrapartida, temos a <strong>hip√≥tese alternativa</strong> <script type="math/tex">H_1 : \theta \in \Theta_1</script> com <script type="math/tex">\Theta_0 \cap \Theta_1 = \emptyset</script> e <script type="math/tex">\theta</script> pertencendo a um dos dois conjuntos.</p>
<p>A perda proposta por Neyman e Pearson √© 
<script type="math/tex; mode=display">
L(\theta, \varphi) = \begin{cases}
    1 &\text{se } \varphi \neq 1_{\Theta_0}(\theta), \\
    0 &\text{c.c.}
\end{cases}
</script>
Para essa perda, o estimador de Bayes √© 
<script type="math/tex; mode=display">
\varphi^{\pi}(x) = \begin{cases}
    1 &\text{se } \Pr(\theta \in \Theta_0 | x) > \Pr(\theta \in \Theta_1 | x), \\
    0 &\text{c.c.}
\end{cases}
</script>
Podemos generalizar essa perda para
<script type="math/tex; mode=display">
L(\theta, \varphi) = \begin{cases}
    0 &\text{se } \varphi = 1_{\Theta_0}(\theta), \\
    a_0 &\text{se } \theta \in \Theta_0 \text{ e } \varphi = 0, \\
    a_1 &\text{se } \theta \in \Theta_1 \text{ e } \varphi = 1, 
\end{cases}
</script>
cujo estimador de Bayes √© <script type="math/tex">\varphi^{\pi}(x) = 1</script> se <script type="math/tex">\Pr(\theta \in \Theta_0 | x) > a_1/(a_0 + a_1)</script>, sendo essa fra√ß√£o o <strong>level de aceita√ß√£o</strong>.</p>
<h3 id="fator-de-bayes">Fator de Bayes</h3>
<p>Definimos o fator de Bayes como a raz√£o das raz√µes da posteriori e da priori:
<script type="math/tex; mode=display">
B_{01}^{\pi}(x) = \frac{\Pr(\theta \in \Theta_0 | x)}{\Pr(\theta \in \Theta_1 | x)}\Big /\frac{\Pr(\theta \in \Theta_0)}{\Pr(\theta \in \Theta_1)} = \frac{\int_{\Theta_0} f(x|\theta)\pi_0(\theta) \, d\theta}{\int_{\Theta_1} f(x|\theta)\pi_1(\theta) \, d\theta},
</script>
que avalia a modifica√ß√£o das chances de <script type="math/tex">\Theta_0</script> contra <script type="math/tex">\Theta_1</script>. 
Observe que <script type="math/tex">\pi_i</script> √© a distribui√ß√£o a priori sob <script type="math/tex">H_i</script>.</p>
<p>Jeffreys desenvolveu uma escala (fora da uma configura√ß√£o baseada em teoria da decis√£o) para avaliar a evid√™ncia trazida por <script type="math/tex">x</script> contra <script type="math/tex">H_0</script>, considerando o valor <script type="math/tex">\log_{10}(B_{10}^{\pi})</script>: 
<script type="math/tex; mode=display">0 < \text{ pobre } < 0.5 < \text{ substancial } < 1 < \text{ forte } < 2 < \text{ decisiva } < +\infty.</script>
</p>
<hr />
<p><code>üìù</code> <strong>Exemplo (Basquete)</strong></p>
<p>Um jogador de basquete tem "m√£o quente" quando tem bons e maus dias, ao inv√©s de uma probabilidade fixa de vencer em um lan√ßamento.
O modelo base √© <script type="math/tex">H_0: y_i \sim B(n_i, p)</script> para cada jogo <script type="math/tex">i=1,\dots, G</script> (<script type="math/tex">p</script> √© fixo). 
A Alternativa √© que <script type="math/tex">p</script> varia com o dia.
Considere a priori <script type="math/tex">p_i \sim Beta(\xi/\omega, (1-\xi)/\omega)</script>, de forma que <script type="math/tex">\xi = \mathbb{E}[p_i|\xi] \sim Unif(0,1)</script>. 
Isto √©, estamos fixando as m√©dias das jogadas dos dias e afirmando que alguns dias teremos <script type="math/tex">p_i > \xi</script> e outros <script type="math/tex">p_i < \xi</script>, √© claro com alguma probabilidade. 
Al√©m do mais, consideramos <script type="math/tex">p \sim Unif(0,1)</script>. 
O fator de Bayes √© 
<script type="math/tex; mode=display">
B_{10} = \frac{\int_0^1 \left\{\prod_{i=1}^G \int_0^1 p_i^{y_i}(1-p_i)^{n_i-y_i}p_i^{\alpha-1}(1-p_i)^{\beta-1} \, dp_i \right\}\left(\Gamma(1/\omega)/\Gamma(\xi/\omega)\Gamma((1-\xi)/\omega)\right)^G \, d\xi}{\int_0^1 p^{\sum y_i}(1-p)^{\sum (n_i-y_i)} \, dp}
</script>
</p>
<p>No paper <a href="https://sites.stat.washington.edu/raftery/Research/PDF/kass1995.pdf">Kass, Raftery (1995)</a>, verificou-se que para <script type="math/tex">\omega = 0.005</script>, temos <script type="math/tex">B_{10} = 0.16</script>, que d√° baixa evid√™ncia a favor de <script type="math/tex">H_1</script>, isto √©, que existem bons e maus dias. Escolhemos <script type="math/tex">\omega</script> olhando para <script type="math/tex">Var(p_i | \xi) = \xi(1-\xi)/(1+\omega^{-1}) \implies \omega^{-1} = \xi(1-\xi)/Var(p_i) - 1.</script>
</p>
<hr />
<p>Note que se <script type="math/tex">H_0</script> for pontual, n√£o conseguimos usar o Fator de Bayes. Para esses casos, precisamos definir 
<script type="math/tex; mode=display">
\pi(\theta) = \Pr(\theta \in \Theta_0) \pi_{0}(\theta) + \Pr(\theta \in \Theta_1) \pi_{1}(\theta) = \varrho_0 \pi_0(\theta) + \varrho_1 \pi_1(\theta).
</script>
Apesar de hip√≥teses pontuais serem problem√°ticas, elas t√™m muita utilidade na pr√°tica. </p>
<p>Assim, teremos a priori <script type="math/tex">\pi(\theta) = \varrho_0 1_{\theta = \theta_0} + (1-\varrho_0)g_1(\theta)</script> com posteriori
<script type="math/tex; mode=display">
\pi(\Theta_0 | x) = \frac{f(x|\theta_0) \varrho_0}{f(x|\theta_0\varrho_0 + (1-\varrho_0)m_1(x))},
</script>
em que <script type="math/tex">m_1</script> √© a marginal dos dados sob <script type="math/tex">H_1</script>. Em particular, o Fator de Bayes √© 
<script type="math/tex; mode=display">
B_{01}^{\pi}(x) = \frac{f(x|\theta_0)}{m_1(x)},
</script>
levando √† rela√ß√£o
<script type="math/tex; mode=display">
\pi(\Theta_0 | x) = \left[1 + \frac{1-\varrho_0}{\varrho_0} \frac{1}{B_{01}(x)}\right]^{-1}.
</script>
</p>
<hr />
<p><code>üìù</code> <strong>Exemplo (Distribui√ß√£o normal)</strong></p>
<p>Considere <script type="math/tex">x \sim \operatorname{Normal}(\theta, 1)</script> e <script type="math/tex">H_0: \theta = 0</script>. 
Se usarmos a priori impr√≥pria <script type="math/tex">\pi(\theta) = \frac{1}{2}1_{\theta = 0} + \frac{1}{2}</script>, teremos que a posteriori de <script type="math/tex">H_0</script> ser√° 
<script type="math/tex; mode=display">
\pi(\theta = 0 | x) = \frac{e^{-x^2/2}}{e^{-x^2/2} + \int e^{-(x-\theta)^2/2} \, d\theta} = \frac{1}{1 + \sqrt{2\pi}e^{x^2/2}} \le 0.285,
</script>
isto √©, a posteriori √© limitada superiormente por um valor baixo. Fen√¥meno parecido acontece quando <script type="math/tex">\Theta_0</script> √© um conjunto compacto. </p>
<p>Uma quest√£o interessante √© que para os n√≠veis tradicionais, que ocorrem quando <script type="math/tex">x = 1.65, 1.96</script> e <script type="math/tex">2.58</script> (respectivamente n√≠veis <script type="math/tex">0.1, 0.05, 0.01</script>), a posteriori de <script type="math/tex">H_0</script> √© pr√≥xima a esses valores (quando a priori √© a medida de Lebesgue).</p>
<p>Em particular, quando <script type="math/tex">H_0 : \theta \le 0</script> para <script type="math/tex">\pi(\theta) = 1</script>, temos que 
<script type="math/tex; mode=display">
\pi(\theta \le 0 | x) = \Phi(-x),
</script>
que √© o <strong>p-valor</strong> desse mesmo teste.</p>
<hr />
<h2 id="comparacao-com-a-abordagem-classica">Compara√ß√£o com a abordagem cl√°ssica</h2>
<h3 id="testes-ump">Testes UMP</h3>
<h3 id="prioris-menos-favoraveis">Prioris menos favor√°veis</h3>
<h3 id="p-valores">p-valores</h3>
<h3 id="respostas-bayesianas-menos-favoraveis">Respostas bayesianas menos favor√°veis</h3>
<h3 id="caso-unilateral">Caso unilateral</h3>
<h2 id="uma-segunda-abordagem">Uma segunda abordagem</h2>
<h2 id="regioes-de-confianca">Regi√µes de confian√ßa</h2>
<h3 id="intervalos-de-credibilidade">Intervalos de credibilidade</h3>
<h3 id="intervalos-de-confianca-classicos">Intervalos de confian√ßa cl√°ssicos</h3>
<h3 id="avaliacao-baseada-em-teoria-da-decisao">Avalia√ß√£o baseada em teoria da decis√£o</h3></div>
        
        
    </div>

    
      <footer class="col-md-12 text-center">
          
          
            <hr>
            <p>
            <small>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</small>
            </p>
          

          
          
      </footer>
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>

    
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js"></script>
        
    <script>hljs.initHighlightingOnLoad();</script>
    

    <script>var base_url = "../.."</script>
    
    <script src="../../js/base.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../search/main.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>
    </body>

</html>
